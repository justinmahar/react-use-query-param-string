import { Meta } from '@storybook/addon-docs';

<Meta title="Hooks/useQueryParamString" />

<h1>useQueryParamString</h1>

## Description

Use this hook to get and set a query param string. You can use this hook the same way you'd use `React.useState()`.

You can also use the `getQueryParams()` and `setQueryParams()` functions to get/set query params yourself.

## Usage

```jsx
import { useQueryParamString } from 'react-use-query-param-string';
```

```jsx
// Will use query param `q` and have a default value of empty string.
// `initialized` will be true after the value has been read from the query params.
const [searchText, setSearchText, initialized] = useQueryParamString('q', '');
```

## Signature

`useQueryParamString(key: string, defaultValue: string) => [value, setValue]`

### Props

| Prop         | Type     | Description                                                  |
| ------------ | -------- | ------------------------------------------------------------ |
| key          | `string` | The key for the query param.                                 |
| defaultValue | `string` | Default value when no string is present in the query params. |

### Return

The hook returns an [array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array) containing:

| Index | Name        | Type                     | Description                                                                |
| ----- | ----------- | ------------------------ | -------------------------------------------------------------------------- |
| 0     | value       | `string`                 | The query param string value                                               |
| 1     | setValue    | `(value: string) â‡’ void` | A setter for the query param value                                         |
| 2     | initialized | `boolean`                | True after the value has been read from the query params. False otherwise. |

## Utility Functions

You can use the `getQueryParams()` and `setQueryParams()` functions to get/set query params yourself.

### `getQueryParams`

Retrieve all decoded query params as a ParsedQuery map.

#### Signature

`getQueryParams() => queryString.ParsedQuery`

#### Usage

```jsx
import { getQueryParams } from 'react-use-query-param-string';
```

```jsx
const params = getQueryParams();
console.log(params);
```

### `setQueryParams`

Set the query params via a ParsedQuery map.

#### Signature

`setQueryParams(query: queryString.ParsedQuery) => void`

#### Usage

```jsx
import { getQueryParams, setQueryParams } from 'react-use-query-param-string';
```

```jsx
const params = getQueryParams();
setQueryParams({ ...params, myParam: 'hey yo!' });
```

## State Synchronization and Event Emitter

This hook uses an event emitter to synchronize state across multiple components.

When state is updated, the event `"update"` is fired on the emitter. This causes all hooks to fetch the latest value from the query params to stay in sync.

To access the emitter directly, you can import it like so:

```jsx
import { queryParamsEventEmitter } from 'react-use-query-param-string';
```

And subscribe for the update event like so:

```jsx
const updateListener = () => {
  console.log('Query params updated');
};

queryParamsEventEmitter.addListener('update', updateListener);
```
